
const WHATSAPP_NUMBER = "41998984617";
let users = {};  // Armazenamento temporário de usuários {email: {name, password}}
let currentUser = null;

document.getElementById('current-year').textContent = new Date().getFullYear();

function getWhatsappLink() {
    return `https://wa.me/55${WHATSAPP_NUMBER.replace(/\D/g, '')}`;
}

function openModal(type) {
    document.getElementById(type === 'login' ? 'login-modal' : 'register-modal').classList.remove('hidden');
    document.body.style.overflow = 'hidden';
}

function closeModal(type) {
    document.getElementById(type === 'login' ? 'login-modal' : 'register-modal').classList.add('hidden');
    document.body.style.overflow = '';
}

/**
 * Registra um novo usuário.
 */
function handleRegister(event) {
    event.preventDefault();
    const name = document.getElementById('register-name').value.trim();
    const email = document.getElementById('register-email').value.trim().toLowerCase();
    const password = document.getElementById('register-password').value;

    if (!name || !email || !password) {
        alert("Preencha todos os campos corretamente.");
        return;
    }

    if (users[email]) {
        alert("Este email já está cadastrado.");
        return;
    }

    users[email] = { name, password };
    alert(`Conta criada com sucesso! Bem-vindo, ${name}.`);
    closeModal('register');
    updateAuthUI(email);
}

/**
 * Realiza login do usuário.
 */
function handleLogin(event) {
    event.preventDefault();
    const email = document.getElementById('login-email').value.trim().toLowerCase();
    const password = document.getElementById('login-password').value;

    if (!users[email]) {
        alert("Usuário não encontrado.");
        return;
    }
    if (users[email].password !== password) {
        alert("Senha incorreta.");
        return;
    }

    alert(`Login realizado com sucesso! Olá, ${users[email].name}.`);
    closeModal('login');
    updateAuthUI(email);
}

/**
 * Atualiza a interface de acordo com o usuário logado.
 */
function updateAuthUI(email) {
    currentUser = email;

    document.getElementById('auth-buttons').classList.add('hidden');
    document.getElementById('user-info').classList.remove('hidden');
    document.getElementById('username-display').textContent = users[email].name;
}

/**
 * Logout do usuário atual.
 */
function logout() {
    currentUser = null;
    document.getElementById('auth-buttons').classList.remove('hidden');
    document.getElementById('user-info').classList.add('hidden');
}

/**
 * Renderiza as páginas simples via JS simulando single-page app.
 */
function renderPage(page, element) {
    const contentArea = document.getElementById('content-area');
    // Atualiza botões de navegação
    document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('nav-active'));
    if (element) element.classList.add('nav-active');

    switch(page) {
        case 'home':
            contentArea.innerHTML = '<h2 class="text-3xl font-bold text-center">Página Home</h2><p class="mt-4 text-center">Conteúdo da Home aqui.</p>';
            break;
        case 'videos':
            contentArea.innerHTML = '<h2 class="text-3xl font-bold text-center">Vídeos</h2><p class="mt-4 text-center">Galeria de vídeos em breve.</p>';
            break;
        case 'filmes':
            contentArea.innerHTML = '<h2 class="text-3xl font-bold text-center">Filmes</h2><p class="mt-4 text-center">Catálogo de filmes premium.</p>';
            break;
        case 'hqs':
            contentArea.innerHTML = '<h2 class="text-3xl font-bold text-center">HQs</h2><p class="mt-4 text-center">Coleção de quadrinhos.</p>';
            break;
        case 'loja':
            contentArea.innerHTML = '<h2 class="text-3xl font-bold text-center">Loja</h2><p class="mt-4 text-center">Compre nossos produtos.</p>';
            break;
        case 'sobre':
            contentArea.innerHTML = '<h2 class="text-3xl font-bold text-center">Sobre</h2><p class="mt-4 text-center">Conheça nosso estúdio.</p>';
            break;
        default:
            contentArea.innerHTML = '<h2 class="text-3xl font-bold text-center">Página não encontrada</h2>';
    }
}
